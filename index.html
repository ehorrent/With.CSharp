<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>With.extensions by ehorrent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">With.extensions</h1>
      <h2 class="project-tagline">Extension methods used to copy and update immutable classes</h2>
      <a href="https://github.com/ehorrent/With.Extensions" class="btn">View on GitHub</a>
      <a href="https://github.com/ehorrent/With.Extensions/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ehorrent/With.Extensions/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="withextensions" class="anchor" href="#withextensions" aria-hidden="true"><span class="octicon octicon-link"></span></a>With.Extensions</h1>

<p>Extension methods used to copy and update immutable classes (as <a href="https://msdn.microsoft.com/en-us/library/dd233184.aspx"><em>copy and update record expression</em></a> in F#).</p>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<div class="highlight highlight-C#"><pre>    <span class="pl-k">var</span> source = Tuple.Create(<span class="pl-s"><span class="pl-pds">"</span>first value<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>second value<span class="pl-pds">"</span></span>);

    <span class="pl-c">// Copy and update 'Item2' member</span>
    <span class="pl-k">var</span> updated = source.With(obj =&gt; obj.Item1, <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span>)
                        .Create();  

    Debug.Assert(
        updated.Item1 == <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span> &amp;&amp;
        updated.Item2 == obj.SecondField);</pre></div>

<h3>
<a id="chaining" class="anchor" href="#chaining" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chaining</h3>

<p>Calling <strong><em>With</em></strong> will cause all future method calls to return wrapped query objects. When you've finished, call <strong><em>Create()</em></strong> to get the final value.</p>

<div class="highlight highlight-C#"><pre>    <span class="pl-k">var</span> source = Tuple.Create(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>);

    <span class="pl-c">// Only create a query object</span>
    <span class="pl-k">var</span> query = source.With(obj =&gt; obj.Item1, <span class="pl-c1">2</span>)
                      .With(obj =&gt; obj.Item2, <span class="pl-s"><span class="pl-pds">"</span>new second value<span class="pl-pds">"</span></span>);

    <span class="pl-c">// Execute the query to create a new object</span>
    <span class="pl-k">var</span> updated = query.Create();  

    Debug.Assert(
      updated.Item1 == <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span> &amp;&amp;
      updated.Item2 == <span class="pl-s"><span class="pl-pds">"</span>new second value<span class="pl-pds">"</span></span> &amp;&amp;
      updated.Item3 == initial.Item3);</pre></div>

<h3>
<a id="how-does-it-work-" class="anchor" href="#how-does-it-work-" aria-hidden="true"><span class="octicon octicon-link"></span></a>How does it work ?</h3>

<p>For a given immutable class, the extension search for actual values to use as parameters in the constructor (by using parameter's name).
All is based on naming conventions : <strong>parameter name must match the name of a field/property</strong> (case is ignored).</p>

<p>For example, the class below won't work with the extension, because there's no matching fields/properties for <em>firstField and secondField</em> parameters :</p>

<div class="highlight highlight-C#"><pre>    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Immutable</span>
    {
        <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">string</span> m_FirstField;
        <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">string</span> m_SecondField;
        <span class="pl-k">public</span> <span class="pl-en">Immutable</span>(<span class="pl-k">string</span> <span class="pl-smi">firstField</span>, <span class="pl-k">string</span> <span class="pl-smi">secondField</span>)
        {
            <span class="pl-c1">this</span>.m_FirstField = firstField;
            <span class="pl-c1">this</span>.m_SecondField = secondField;
        }
    }

    ...

    <span class="pl-k">var</span> instance = <span class="pl-k">new</span> Immutable(<span class="pl-s"><span class="pl-pds">"</span>first value<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>second value<span class="pl-pds">"</span></span>);

    <span class="pl-c">// 'Create()' call will throw an exception</span>
    instance.With(obj =&gt; obj.m_FirstField, <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span>)
            .Create();</pre></div>

<h3>
<a id="download" class="anchor" href="#download" aria-hidden="true"><span class="octicon octicon-link"></span></a>Download</h3>

<p>NuGet package can be downloaded <a href="https://www.nuget.org/packages/With.Extensions">here</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ehorrent/With.Extensions">With.extensions</a> is maintained by <a href="https://github.com/ehorrent">ehorrent</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

