<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>With.Extensions by ehorrent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">With.Extensions</h1>
      <h2 class="project-tagline">Extension methods used to copy and update immutable classes</h2>
      <a href="https://github.com/ehorrent/With.Extensions" class="btn">View on GitHub</a>
      <a href="https://github.com/ehorrent/With.Extensions/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ehorrent/With.Extensions/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="withextensions---" class="anchor" href="#withextensions---" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>With.Extensions <a href="https://travis-ci.org/ehorrent/With.Extensions"><img src="https://travis-ci.org/ehorrent/With.Extensions.svg?branch=master" alt="Travis build status"></a> <a href="https://ci.appveyor.com/project/ehorrent/with-extensions"><img src="https://ci.appveyor.com/api/projects/status/rrj9mjjjyut92qhj?svg=true" alt="AppVeayor build status"></a> <a href="https://www.nuget.org/packages/With.Extensions/"><img src="http://img.shields.io/nuget/v/With.Extensions.svg?style=flat" alt="NuGet Status"></a>
</h1>

<p>Extension methods used to copy and update immutable classes (as <a href="https://msdn.microsoft.com/en-us/library/dd233184.aspx"><em>copy and update record expression</em></a> in F#).</p>

<h2>
<a id="why-" class="anchor" href="#why-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why ?</h2>

<p>When using immutables classes with <strong>C#</strong>, it becomes really annoying to copy and update an object. To do that, you have 2 options :</p>

<ul>
<li>use the constructor (verbose and add 'noise' on what you really want to do)</li>
<li>create manually copy methods to duplicate your object</li>
</ul>

<p>The second solution makes your code more readable but you have to create methods for each field you want to modify in your class, and it can be a lot of work...</p>

<p>This project has been created to supply extensions to <strong>duplicate easily your immutable classes in C#</strong> (of course if you have the choice, you should use <a href="http://fsharp.org/">F#</a>...)</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<div class="highlight highlight-source-cs"><pre>  <span class="pl-k">var</span> source = Tuple.Create(<span class="pl-s"><span class="pl-pds">"</span>first value<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>second value<span class="pl-pds">"</span></span>);

  <span class="pl-c">// Copy and update 'Item1' member</span>
  <span class="pl-k">var</span> updated = source.With(obj =&gt; obj.Item1, <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span>)
                      .Create();  

  Debug.Assert(
    updated.Item1 == <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span> &amp;&amp;
    updated.Item2 == source.Item2);</pre></div>

<h4>
<a id="chaining" class="anchor" href="#chaining" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chaining</h4>

<p>Calling <strong><em>With extension</em></strong> will cause all future method calls to return wrapped query objects. When you've finished, call <strong><em>Create()</em></strong> to get the final value.</p>

<div class="highlight highlight-source-cs"><pre>  <span class="pl-k">var</span> source = Tuple.Create(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>);

  <span class="pl-c">// Only create a query object</span>
  <span class="pl-k">var</span> query = source.With(obj =&gt; obj.Item1, <span class="pl-c1">2</span>)
                    .With(obj =&gt; obj.Item2, <span class="pl-c1">4</span>);

  <span class="pl-c">// Execute the query to create a new object</span>
  <span class="pl-k">var</span> updated = query.Create();

  Debug.Assert(
    updated.Item1 == <span class="pl-c1">2</span> &amp;&amp;
    updated.Item2 == <span class="pl-c1">4</span> &amp;&amp;
    updated.Item3 == source.Item3);</pre></div>

<h2>
<a id="how-does-it-work-" class="anchor" href="#how-does-it-work-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How does it work ?</h2>

<p>For a given immutable class, the extension search for actual values to use as parameters in the constructor (by using parameter's name).</p>

<h4>
<a id="restrictions" class="anchor" href="#restrictions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Restrictions</h4>

<p>To use the extension, your immutable class must define a <strong>unique constructor</strong>.</p>

<h4>
<a id="naming-conventions" class="anchor" href="#naming-conventions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Naming conventions</h4>

<p>By default, name of a constructor argument must match the name of a corresponding field/property (using <strong>pascal case convention</strong>). For example, if a constructor argument is named 'defaultValue', extension will search for a field/property named 'DefaultValue'.</p>

<p>When calling <strong>Create</strong>, you can override default behavior by providing your own name converter.
For example, if you use 'm_' prefixes like below :</p>

<div class="highlight highlight-source-cs"><pre>  <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Immutable</span>
  {
    <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">string</span> m_FirstField;
    <span class="pl-k">public</span> <span class="pl-k">readonly</span> <span class="pl-k">string</span> m_SecondField;

    <span class="pl-k">public</span> <span class="pl-en">Immutable</span>(<span class="pl-k">string</span> <span class="pl-smi">firstField</span>, <span class="pl-k">string</span> <span class="pl-smi">secondField</span>)
    {
      <span class="pl-c1">this</span>.m_FirstField = firstField;
      <span class="pl-c1">this</span>.m_SecondField = secondField;
    }
  }

  ...

  <span class="pl-k">var</span> instance = <span class="pl-k">new</span> Immutable(<span class="pl-s"><span class="pl-pds">"</span>first value<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>second value<span class="pl-pds">"</span></span>);
  <span class="pl-k">var</span> updated = instance.With(obj =&gt; obj.m_FirstField, <span class="pl-s"><span class="pl-pds">"</span>new first value<span class="pl-pds">"</span></span>)
                        .Create(name =&gt;
                          <span class="pl-k">string</span>.Concat(<span class="pl-s"><span class="pl-pds">"</span>m_<span class="pl-pds">"</span></span>, Naming.PascalCase.Convert(name)));</pre></div>

<h2>
<a id="download" class="anchor" href="#download" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Download</h2>

<p>NuGet package can be downloaded <a href="https://www.nuget.org/packages/With.Extensions">here</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ehorrent/With.Extensions">With.Extensions</a> is maintained by <a href="https://github.com/ehorrent">ehorrent</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
